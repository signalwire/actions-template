name: Trivy scan
description: Trivy docker container vulnerability assessment

inputs:
  IMAGE:
    required: true
  TRIVY_IGNORES:
    required: false
    
runs:
  using: "composite"
  steps:
  - uses: aquasecurity/trivy-action@master
    with:
      token: ${{ env.GITHUB_TOKEN }}
      image-ref: ${{ inputs.IMAGE }}
      format: 'table'
      severity: 'HIGH,CRITICAL'
      fail_on_vulnerabilities: false
      exit-code: '1'
      ignore-unfixed: true
      vuln-type: 'os,library'
