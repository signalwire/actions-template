name: Slack notification
description: Send Slack messages using WebHooks

inputs:
  CHANNEL: 
    description: Channel to post a message
    required: true
  MESSAGE:
    description: Text message to post
    required: true

runs:
  using: composite
  steps:
    - name: Remove quotes
      run: echo 'MESSAGE=${{inputs.MESSAGE}}' | jq -r . >> $GITHUB_ENV
      shell: bash
    - name: Send custom JSON data to Slack workflow
      id: slack
      uses: slackapi/slack-github-action@v1.23.0
      with:
        payload: |
          {
            "text": "${{ env.MESSAGE }}",
            "channel": "${{ inputs.CHANNEL }}",
            "username": "webhookbot",
            "icon_emoji": ":ghost:",
            "blocks": [
              {
                "type": "section",
                "text": {
                  "type": "mrkdwn",
                  "text": "${{ env.MESSAGE }}"
                }
              }
            ]
          }
      env:
        SLACK_WEBHOOK_URL: ${{ env.SLACK_WEBHOOK_URL }}
        SLACK_WEBHOOK_TYPE: INCOMING_WEBHOOK